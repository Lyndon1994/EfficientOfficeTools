function parseUrl(e){let n={},t=/([^?=&]+)=([^?=&]+)/g;return e.replace(t,(function(){n[arguments[1]]=arguments[2]})),n}function addContextMenus(){chrome.contextMenus.removeAll();let e={engines:chrome.i18n.getMessage("defaultEnginesConfig")};chrome.storage.sync.get(e,(function(e){let n=JSON.parse(e.engines);n.forEach((function(e){e.name&&e.url&&e.inRight&&chrome.contextMenus.create({title:chrome.i18n.getMessage("searchFor",e.name),id:e.url,contexts:["selection"]})}))}))}chrome.contextMenus.onClicked.addListener((function(e,n){chrome.tabs.create({url:e.menuItemId.replace("%s",encodeURIComponent(e.selectionText))})})),chrome.runtime.onStartup.addListener(addContextMenus),chrome.runtime.onInstalled.addListener(addContextMenus),chrome.runtime.onMessage.addListener((function(e,n,t){chrome.contextMenus.removeAll(),e.forEach((function(e){e.name&&e.url&&e.inRight&&chrome.contextMenus.create({title:chrome.i18n.getMessage("searchFor",e.name),id:e.url,contexts:["selection"]})})),t("done")})),chrome.commands.onCommand.addListener((function(e){"toggle-search"===e&&chrome.tabs.query({active:!0},(function(e){let n=e[0],t=parseUrl(n.url),o=n.url.split("/")[2].split(".")[1],r=t["wd"]||t["word"]||t["w"]||t["q"]||t["query"];if(r){let e={engines:chrome.i18n.getMessage("defaultEnginesConfig")};chrome.storage.sync.get(e,(function(e){let n=JSON.parse(e.engines);if(n.length<1)return void console.log("no engine");let t=!1,c=!1;n.forEach((function(e){if(!c&&e.name&&e.url&&e.inShortcuts){if(!0===t)return c=!0,void chrome.tabs.update({url:e.url.replace("%s",r)});e.domain=e.url.split("/")[2].split(".")[1],e.domain==o&&(t=!0)}})),!1===c&&chrome.tabs.update({url:n[0].url.replace("%s",r)})}))}}))}));